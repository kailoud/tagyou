<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mobile Auth Test</title>
  <link rel="stylesheet" href="mobile-styles.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      margin: 0;
    }

    .test-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .test-button {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin: 10px;
      transition: all 0.3s ease;
    }

    .test-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
    }

    .status {
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      font-weight: 600;
    }

    .status.success {
      background: #e8f5e8;
      color: #2e7d32;
      border: 1px solid #4caf50;
    }

    .status.error {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #f44336;
    }

    .status.info {
      background: #e3f2fd;
      color: #1565c0;
      border: 1px solid #2196f3;
    }
  </style>
</head>

<body>
  <div class="test-container">
    <h1>üì± Mobile Auth Popup Test</h1>

    <div id="status" class="status info">
      Initializing...
    </div>

    <div>
      <button class="test-button" onclick="testSignIn()">üîê Test Sign In Popup</button>
      <button class="test-button" onclick="testSignUp()">üìù Test Sign Up Popup</button>
      <button class="test-button" onclick="testMobileAuth()">üì± Test Mobile Auth</button>
      <button class="test-button" onclick="checkStatus()">üîç Check Status</button>
    </div>

    <div id="output"
      style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px; font-family: monospace; font-size: 14px; max-height: 300px; overflow-y: auto;">
      <div>Console output will appear here...</div>
    </div>
  </div>

  <!-- Load Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <!-- Load your scripts -->
  <script src="firebase-config.js"></script>
  <script src="auth-service.js"></script>
  <script src="mobile-auth.js"></script>

  <script>
    function log(message) {
      console.log(message);
      const output = document.getElementById('output');
      const timestamp = new Date().toLocaleTimeString();
      output.innerHTML += `<div>[${timestamp}] ${message}</div>`;
      output.scrollTop = output.scrollHeight;
    }

    function updateStatus(message, type = 'info') {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = `status ${type}`;
    }

    function checkStatus() {
      log('=== Checking Status ===');
      log(`Auth Service: ${window.authService ? '‚úÖ Available' : '‚ùå Not Available'}`);
      log(`Mobile Auth: ${window.mobileAuth ? '‚úÖ Available' : '‚ùå Not Available'}`);

      if (window.authService) {
        log(`Auth Service Methods: ${Object.keys(window.authService).join(', ')}`);
        log(`showSignInModal: ${typeof window.authService.showSignInModal}`);
        log(`showSignUpModal: ${typeof window.authService.showSignUpModal}`);
      }

      if (window.mobileAuth) {
        log(`Mobile Auth Methods: ${Object.keys(window.mobileAuth).join(', ')}`);
        log(`showSignInModal: ${typeof window.mobileAuth.showSignInModal}`);
        log(`showSignUpModal: ${typeof window.mobileAuth.showSignUpModal}`);
      }

      updateStatus('Status checked - see console output', 'success');
    }

    function testSignIn() {
      log('=== Testing Sign In Popup ===');

      if (window.mobileAuth && typeof window.mobileAuth.showSignInModal === 'function') {
        log('‚úÖ Calling mobile auth showSignInModal...');
        try {
          window.mobileAuth.showSignInModal();
          updateStatus('Sign In popup should be visible!', 'success');
        } catch (error) {
          log(`‚ùå Error: ${error.message}`);
          updateStatus('Error showing Sign In popup', 'error');
        }
      } else if (window.authService && typeof window.authService.showSignInModal === 'function') {
        log('‚úÖ Calling auth service showSignInModal...');
        try {
          window.authService.showSignInModal();
          updateStatus('Sign In popup should be visible!', 'success');
        } catch (error) {
          log(`‚ùå Error: ${error.message}`);
          updateStatus('Error showing Sign In popup', 'error');
        }
      } else {
        log('‚ùå Neither mobile auth nor auth service available');
        updateStatus('No auth service available', 'error');
      }
    }

    function testSignUp() {
      log('=== Testing Sign Up Popup ===');

      if (window.mobileAuth && typeof window.mobileAuth.showSignUpModal === 'function') {
        log('‚úÖ Calling mobile auth showSignUpModal...');
        try {
          window.mobileAuth.showSignUpModal();
          updateStatus('Sign Up popup should be visible!', 'success');
        } catch (error) {
          log(`‚ùå Error: ${error.message}`);
          updateStatus('Error showing Sign Up popup', 'error');
        }
      } else if (window.authService && typeof window.authService.showSignUpModal === 'function') {
        log('‚úÖ Calling auth service showSignUpModal...');
        try {
          window.authService.showSignUpModal();
          updateStatus('Sign Up popup should be visible!', 'success');
        } catch (error) {
          log(`‚ùå Error: ${error.message}`);
          updateStatus('Error showing Sign Up popup', 'error');
        }
      } else {
        log('‚ùå Neither mobile auth nor auth service available');
        updateStatus('No auth service available', 'error');
      }
    }

    function testMobileAuth() {
      log('=== Testing Mobile Auth ===');

      if (window.mobileAuth) {
        log('‚úÖ Mobile auth is available');
        log(`Methods: ${Object.keys(window.mobileAuth).join(', ')}`);

        // Test if we can create a simple modal
        try {
          const modalHTML = `
                        <div id="testModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;">
                            <div style="background: white; padding: 30px; border-radius: 15px; max-width: 400px; width: 90%;">
                                <h2>üß™ Test Modal</h2>
                                <p>This is a test modal to verify mobile auth is working.</p>
                                <button onclick="document.getElementById('testModal').remove()" style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Close</button>
                            </div>
                        </div>
                    `;

          document.body.insertAdjacentHTML('beforeend', modalHTML);
          log('‚úÖ Test modal created successfully');
          updateStatus('Test modal created - mobile auth is working!', 'success');
        } catch (error) {
          log(`‚ùå Error creating test modal: ${error.message}`);
          updateStatus('Error creating test modal', 'error');
        }
      } else {
        log('‚ùå Mobile auth not available');
        updateStatus('Mobile auth not available', 'error');
      }
    }

    // Initialize when page loads
    window.addEventListener('load', () => {
      log('=== Page Loaded ===');

      // Wait a bit for scripts to load
      setTimeout(() => {
        log('Checking for auth services...');
        checkStatus();
      }, 1000);
    });

    // Also check after a longer delay
    setTimeout(() => {
      log('=== Delayed Check ===');
      checkStatus();
    }, 3000);
  </script>
</body>

</html>